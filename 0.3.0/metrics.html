
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://cangyuanli.github.io/rapidstats/0.3.0/metrics.html">
      
      
        <link rel="prev" href="drift.html">
      
      
        <link rel="next" href="polars.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Metrics - rapidstats API Reference</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rapidstats.metrics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="rapidstats API Reference" class="md-header__button md-logo" aria-label="rapidstats API Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            rapidstats API Reference
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Metrics
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CangyuanLi/rapidstats" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="rapidstats API Reference" class="md-nav__button md-logo" aria-label="rapidstats API Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    rapidstats API Reference
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CangyuanLi/rapidstats" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="bin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Binning
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="bootstrap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bootstrap
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="correlation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Correlation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="distributions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="drift.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Drift
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="metrics.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.ConfusionMatrix" class="md-nav__link">
    <span class="md-ellipsis">
      ConfusionMatrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConfusionMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rapidstats.metrics.ConfusionMatrix.to_polars" class="md-nav__link">
    <span class="md-ellipsis">
      to_polars
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.adverse_impact_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      adverse_impact_ratio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.adverse_impact_ratio_at_thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      adverse_impact_ratio_at_thresholds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.average_precision" class="md-nav__link">
    <span class="md-ellipsis">
      average_precision
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.brier_loss" class="md-nav__link">
    <span class="md-ellipsis">
      brier_loss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.confusion_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.confusion_matrix_at_thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix_at_thresholds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.max_ks" class="md-nav__link">
    <span class="md-ellipsis">
      max_ks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.mean" class="md-nav__link">
    <span class="md-ellipsis">
      mean
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.mean_squared_error" class="md-nav__link">
    <span class="md-ellipsis">
      mean_squared_error
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.predicted_positive_ratio_at_thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      predicted_positive_ratio_at_thresholds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.r2" class="md-nav__link">
    <span class="md-ellipsis">
      r2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.roc_auc" class="md-nav__link">
    <span class="md-ellipsis">
      roc_auc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.root_mean_squared_error" class="md-nav__link">
    <span class="md-ellipsis">
      root_mean_squared_error
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="polars.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Polars
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="preprocessing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preprocessing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="misc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.ConfusionMatrix" class="md-nav__link">
    <span class="md-ellipsis">
      ConfusionMatrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConfusionMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rapidstats.metrics.ConfusionMatrix.to_polars" class="md-nav__link">
    <span class="md-ellipsis">
      to_polars
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.adverse_impact_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      adverse_impact_ratio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.adverse_impact_ratio_at_thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      adverse_impact_ratio_at_thresholds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.average_precision" class="md-nav__link">
    <span class="md-ellipsis">
      average_precision
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.brier_loss" class="md-nav__link">
    <span class="md-ellipsis">
      brier_loss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.confusion_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.confusion_matrix_at_thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix_at_thresholds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.max_ks" class="md-nav__link">
    <span class="md-ellipsis">
      max_ks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.mean" class="md-nav__link">
    <span class="md-ellipsis">
      mean
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.mean_squared_error" class="md-nav__link">
    <span class="md-ellipsis">
      mean_squared_error
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.predicted_positive_ratio_at_thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      predicted_positive_ratio_at_thresholds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.r2" class="md-nav__link">
    <span class="md-ellipsis">
      r2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.roc_auc" class="md-nav__link">
    <span class="md-ellipsis">
      roc_auc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rapidstats.metrics.root_mean_squared_error" class="md-nav__link">
    <span class="md-ellipsis">
      root_mean_squared_error
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Metrics</h1>

<div class="doc doc-object doc-module">



<a id="rapidstats.metrics"></a>
    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="ConfusionMatrix


  
      dataclass
   (rapidstats.metrics.ConfusionMatrix)" href="#rapidstats.metrics.ConfusionMatrix">ConfusionMatrix</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Result object returned by <code>rapidstats.metrics.confusion_matrix</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="adverse_impact_ratio(y_pred, protected, control, sample_weight=None) (rapidstats.metrics.adverse_impact_ratio)" href="#rapidstats.metrics.adverse_impact_ratio">adverse_impact_ratio</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes the Adverse Impact Ratio (AIR), which is the ratio of negative</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="adverse_impact_ratio_at_thresholds(y_score, protected, control, sample_weight=None, thresholds=None, strategy='auto') (rapidstats.metrics.adverse_impact_ratio_at_thresholds)" href="#rapidstats.metrics.adverse_impact_ratio_at_thresholds">adverse_impact_ratio_at_thresholds</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes the Adverse Impact Ratio (AIR) at each threshold of <code>y_score</code>. See</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="average_precision(y_true, y_score, sample_weight=None) (rapidstats.metrics.average_precision)" href="#rapidstats.metrics.average_precision">average_precision</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes Average Precision.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="brier_loss(y_true, y_score) (rapidstats.metrics.brier_loss)" href="#rapidstats.metrics.brier_loss">brier_loss</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes the Brier loss (smaller is better). The Brier loss measures the mean</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="confusion_matrix(y_true, y_pred, beta=1.0, sample_weight=None) (rapidstats.metrics.confusion_matrix)" href="#rapidstats.metrics.confusion_matrix">confusion_matrix</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes confusion matrix metrics (TP, FP, TN, FN, TPR, Fbeta, etc.).</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="confusion_matrix_at_thresholds(y_true, y_score, thresholds=None, metrics=DefaultConfusionMatrixMetrics, strategy='auto', beta=1.0, sample_weight=None) (rapidstats.metrics.confusion_matrix_at_thresholds)" href="#rapidstats.metrics.confusion_matrix_at_thresholds">confusion_matrix_at_thresholds</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes the confusion matrix at each threshold. When the <code>strategy</code> is</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="max_ks(y_true, y_score) (rapidstats.metrics.max_ks)" href="#rapidstats.metrics.max_ks">max_ks</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Performs the two-sample Kolmogorov-Smirnov test on the predicted scores of the</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="mean(y) (rapidstats.metrics.mean)" href="#rapidstats.metrics.mean">mean</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes the mean of the input array.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="mean_squared_error(y_true, y_score) (rapidstats.metrics.mean_squared_error)" href="#rapidstats.metrics.mean_squared_error">mean_squared_error</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes Mean Squared Error (MSE) as</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="predicted_positive_ratio_at_thresholds(y_score, sample_weight=None, thresholds=None, strategy='auto') (rapidstats.metrics.predicted_positive_ratio_at_thresholds)" href="#rapidstats.metrics.predicted_positive_ratio_at_thresholds">predicted_positive_ratio_at_thresholds</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes the Predicted Positive Ratio (PPR) at each threshold, where the PPR is</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="r2(y_true, y_score) (rapidstats.metrics.r2)" href="#rapidstats.metrics.r2">r2</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes R2 as</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="roc_auc(y_true, y_score, sample_weight=None) (rapidstats.metrics.roc_auc)" href="#rapidstats.metrics.roc_auc">roc_auc</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes Area Under the Receiver Operating Characteristic Curve.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="root_mean_squared_error(y_true, y_score) (rapidstats.metrics.root_mean_squared_error)" href="#rapidstats.metrics.root_mean_squared_error">root_mean_squared_error</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes Root Mean Squared Error (RMSE) as</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>





  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="rapidstats.metrics.ConfusionMatrix" class="doc doc-heading">
            <code>ConfusionMatrix</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Result object returned by <code>rapidstats.metrics.confusion_matrix</code></p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.tn">tn</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Count of True Negatives; y_true == False and y_pred == False</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.fp">fp</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↓Count of False Positives; y_true == False and y_pred == True</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.fn">fn</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↓Count of False Negatives; y_true == True and y_pred == False</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.tp">tp</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Count of True Positives; y_true == True, y_pred == True</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.tpr">tpr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑True Positive Rate, Recall, Sensitivity; Probability that an actual positive
will be predicted positive; <span class="arithmatex">\( \frac{TP}{TP + FN} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.fpr">fpr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↓False Positive Rate, Type I Error; Probability that an actual negative will
be predicted positive; <span class="arithmatex">\( \frac{FP}{FP + TN} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.fnr">fnr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↓False Negative Rate, Type II Error; Probability an actual positive will be
predicted negative; <span class="arithmatex">\( \frac{FN}{TP + FN} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.tnr">tnr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑True Negative Rate, Specificity; Probability an actual negative will be
predicted negative; <span class="arithmatex">\( \frac{TN}{FP + TN} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.prevalence">prevalence</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prevalence; Proportion of positive classes; <span class="arithmatex">\( \frac{TP + FN}{TN + FP + FN + TP} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.prevalence_threshold">prevalence_threshold</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prevalence Threshold; <span class="arithmatex">\( \frac{\sqrt{TPR \times FPR} - FPR}{TPR - FPR} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.informedness">informedness</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Informedness, Youden's J; <span class="arithmatex">\( TPR + TNR - 1 \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.precision">precision</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Precision, Positive Predicted Value (PPV); Probability a predicted positive was
actually correct; <span class="arithmatex">\( \frac{TP}{TP + FP} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.false_omission_rate">false_omission_rate</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↓False Omission Rate (FOR); Proportion of predicted negatives that were wrong
<span class="arithmatex">\( \frac{FN}{FN + TN} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.plr">plr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Positive Likelihood Ratio, LR+; <span class="arithmatex">\( \frac{TPR}{FPR} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.nlr">nlr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Negative Likelihood Ratio, LR-; <span class="arithmatex">\( \frac{FNR}{TNR} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.acc">acc</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Accuracy (ACC); Probability of a correct prediction; <span class="arithmatex">\( \frac{TP + TN}{TN + FP + FN + TP} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.balanced_accuracy">balanced_accuracy</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Balanced Accuracy (BA); <span class="arithmatex">\( \frac{TP + TN}{2} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.fbeta">fbeta</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑<span class="arithmatex">\( F_{\beta} \)</span>; Harmonic mean of Precision and Recall; <span class="arithmatex">\( \frac{(1 + \beta)^2 \times PPV \times TPR}{(\beta^2 \times PPV) + TPR} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.folkes_mallows_index">folkes_mallows_index</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Folkes Mallows Index (FM); <span class="arithmatex">\( \sqrt{PPV \times TPR} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.mcc">mcc</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Matthew Correlation Coefficient (MCC), Yule Phi Coefficient; <span class="arithmatex">\( \sqrt{TPR \times TNR \times PPV \times NPV} - \sqrt{FNR \times FPR \times FOR \times FDR} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.threat_score">threat_score</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↑Threat Score (TS), Critical Success Index (CSI), Jaccard Index; <span class="arithmatex">\( \frac{TP}{TP + FN + FP} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.markedness">markedness</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Markedness (MP), deltaP; <span class="arithmatex">\( PPV + NPV - 1 \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.fdr">fdr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>↓False Discovery Rate, Proportion of predicted positives that are wrong; <span class="arithmatex">\( \frac{FP}{TP + FP} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.↑npv">↑npv</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Negative Predictive Value; Proportion of predicted negatives that are correct; <span class="arithmatex">\( \frac{TN}{FN + TN} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.dor">dor</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Diagnostic Odds Ratio; <span class="arithmatex">\( \frac{LR+}{LR-} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.ppr">ppr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted Positive Ratio; Proportion that are predicted positive; <span class="arithmatex">\( \frac{TP + FP}{TN + FP + FN + TP} \)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rapidstats.metrics.ConfusionMatrix.pnr">pnr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted Negative Ratio; Proportion that are predicted negative; <span class="arithmatex">\( \frac{TN + FN}{TN + FP + FN + TP} \)</span></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>












<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="to_polars() (rapidstats.metrics.ConfusionMatrix.to_polars)" href="#rapidstats.metrics.ConfusionMatrix.to_polars">to_polars</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Convert the dataclass to a long Polars DataFrame with columns <code>metric</code> and</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



              <details class="quote">
                <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConfusionMatrix</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Result object returned by `rapidstats.metrics.confusion_matrix`</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    tn : float</span>
<span class="sd">        ↑Count of True Negatives; y_true == False and y_pred == False</span>
<span class="sd">    fp : float</span>
<span class="sd">        ↓Count of False Positives; y_true == False and y_pred == True</span>
<span class="sd">    fn : float</span>
<span class="sd">        ↓Count of False Negatives; y_true == True and y_pred == False</span>
<span class="sd">    tp : float</span>
<span class="sd">        ↑Count of True Positives; y_true == True, y_pred == True</span>
<span class="sd">    tpr : float</span>
<span class="sd">        ↑True Positive Rate, Recall, Sensitivity; Probability that an actual positive</span>
<span class="sd">        will be predicted positive; \( \frac{TP}{TP + FN} \)</span>
<span class="sd">    fpr : float</span>
<span class="sd">        ↓False Positive Rate, Type I Error; Probability that an actual negative will</span>
<span class="sd">        be predicted positive; \( \frac{FP}{FP + TN} \)</span>
<span class="sd">    fnr : float</span>
<span class="sd">        ↓False Negative Rate, Type II Error; Probability an actual positive will be</span>
<span class="sd">        predicted negative; \( \frac{FN}{TP + FN} \)</span>
<span class="sd">    tnr : float</span>
<span class="sd">        ↑True Negative Rate, Specificity; Probability an actual negative will be</span>
<span class="sd">        predicted negative; \( \frac{TN}{FP + TN} \)</span>
<span class="sd">    prevalence : float</span>
<span class="sd">        Prevalence; Proportion of positive classes; \( \frac{TP + FN}{TN + FP + FN + TP} \)</span>
<span class="sd">    prevalence_threshold : float</span>
<span class="sd">        Prevalence Threshold; \( \frac{\sqrt{TPR \times FPR} - FPR}{TPR - FPR} \)</span>
<span class="sd">    informedness : float</span>
<span class="sd">        ↑Informedness, Youden&#39;s J; \( TPR + TNR - 1 \)</span>
<span class="sd">    precision : float</span>
<span class="sd">        ↑Precision, Positive Predicted Value (PPV); Probability a predicted positive was</span>
<span class="sd">        actually correct; \( \frac{TP}{TP + FP} \)</span>
<span class="sd">    false_omission_rate : float</span>
<span class="sd">        ↓False Omission Rate (FOR); Proportion of predicted negatives that were wrong</span>
<span class="sd">        \( \frac{FN}{FN + TN} \)</span>
<span class="sd">    plr : float</span>
<span class="sd">        ↑Positive Likelihood Ratio, LR+; \( \frac{TPR}{FPR} \)</span>
<span class="sd">    nlr : float</span>
<span class="sd">        Negative Likelihood Ratio, LR-; \( \frac{FNR}{TNR} \)</span>
<span class="sd">    acc : float</span>
<span class="sd">        ↑Accuracy (ACC); Probability of a correct prediction; \( \frac{TP + TN}{TN + FP + FN + TP} \)</span>
<span class="sd">    balanced_accuracy : float</span>
<span class="sd">        ↑Balanced Accuracy (BA); \( \frac{TP + TN}{2} \)</span>
<span class="sd">    fbeta : float</span>
<span class="sd">        ↑\( F_{\beta} \); Harmonic mean of Precision and Recall; \( \frac{(1 + \beta)^2 \times PPV \times TPR}{(\beta^2 \times PPV) + TPR} \)</span>
<span class="sd">    folkes_mallows_index : float</span>
<span class="sd">        ↑Folkes Mallows Index (FM); \( \sqrt{PPV \times TPR} \)</span>
<span class="sd">    mcc : float</span>
<span class="sd">        ↑Matthew Correlation Coefficient (MCC), Yule Phi Coefficient; \( \sqrt{TPR \times TNR \times PPV \times NPV} - \sqrt{FNR \times FPR \times FOR \times FDR} \)</span>
<span class="sd">    threat_score : float</span>
<span class="sd">        ↑Threat Score (TS), Critical Success Index (CSI), Jaccard Index; \( \frac{TP}{TP + FN + FP} \)</span>
<span class="sd">    markedness : float</span>
<span class="sd">        Markedness (MP), deltaP; \( PPV + NPV - 1 \)</span>
<span class="sd">    fdr : float</span>
<span class="sd">        ↓False Discovery Rate, Proportion of predicted positives that are wrong; \( \frac{FP}{TP + FP} \)</span>
<span class="sd">    ↑npv : float</span>
<span class="sd">        Negative Predictive Value; Proportion of predicted negatives that are correct; \( \frac{TN}{FN + TN} \)</span>
<span class="sd">    dor : float</span>
<span class="sd">        Diagnostic Odds Ratio; \( \frac{LR+}{LR-} \)</span>
<span class="sd">    ppr : float</span>
<span class="sd">        Predicted Positive Ratio; Proportion that are predicted positive; \( \frac{TP + FP}{TN + FP + FN + TP} \)</span>
<span class="sd">    pnr : float</span>
<span class="sd">        Predicted Negative Ratio; Proportion that are predicted negative; \( \frac{TN + FN}{TN + FP + FN + TP} \)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tn</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">fp</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">fn</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">tp</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">tpr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">fpr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">fnr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">tnr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">prevalence</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">prevalence_threshold</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">informedness</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">precision</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">false_omission_rate</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">plr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">nlr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">acc</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">balanced_accuracy</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">fbeta</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">folkes_mallows_index</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">mcc</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">threat_score</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">markedness</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">fdr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">npv</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">dor</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">ppr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">pnr</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_polars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the dataclass to a long Polars DataFrame with columns `metric` and</span>
<span class="sd">        `value`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pl.DataFrame</span>
<span class="sd">            DataFrame with columns `metric` and `value`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>

        <span class="k">return</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="n">dct</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">dct</span><span class="o">.</span><span class="n">values</span><span class="p">()})</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="rapidstats.metrics.ConfusionMatrix.to_polars" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_polars</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the dataclass to a long Polars DataFrame with columns <code>metric</code> and
<code>value</code>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="polars.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with columns <code>metric</code> and <code>value</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_polars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the dataclass to a long Polars DataFrame with columns `metric` and</span>
<span class="sd">    `value`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pl.DataFrame</span>
<span class="sd">        DataFrame with columns `metric` and `value`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>

    <span class="k">return</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="n">dct</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">dct</span><span class="o">.</span><span class="n">values</span><span class="p">()})</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.adverse_impact_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">adverse_impact_ratio</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">protected</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the Adverse Impact Ratio (AIR), which is the ratio of negative
predictions for the protected class and the control class. The ideal ratio is 1.
For example, in an underwriting context, this means that the model is equally as
likely to approve protected applicants as it is unprotected applicants, given that
the model score is probability of bad.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_pred</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted negative</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>protected</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array of booleans identifying the protected class</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array of booleans identifying the control class</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_weight</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="polars.series.series.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample weights, set to 1 if None</p>
<div class="admonition version">
<p class="admonition-title">Version</p>
<p>Added 0.2.0</p>
</div>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adverse Impact Ratio (AIR)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">adverse_impact_ratio</span><span class="p">(</span>
    <span class="n">y_pred</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">protected</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">control</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the Adverse Impact Ratio (AIR), which is the ratio of negative</span>
<span class="sd">    predictions for the protected class and the control class. The ideal ratio is 1.</span>
<span class="sd">    For example, in an underwriting context, this means that the model is equally as</span>
<span class="sd">    likely to approve protected applicants as it is unprotected applicants, given that</span>
<span class="sd">    the model score is probability of bad.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_pred : ArrayLike</span>
<span class="sd">        Predicted negative</span>
<span class="sd">    protected : ArrayLike</span>
<span class="sd">        An array of booleans identifying the protected class</span>
<span class="sd">    control : ArrayLike</span>
<span class="sd">        An array of booleans identifying the control class</span>
<span class="sd">    sample_weight: Optional[ArrayLike], optional</span>
<span class="sd">        Sample weights, set to 1 if None</span>

<span class="sd">        !!! Version</span>
<span class="sd">            Added 0.2.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Adverse Impact Ratio (AIR)</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_adverse_impact_ratio</span><span class="p">(</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;y_pred&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
                <span class="s2">&quot;protected&quot;</span><span class="p">:</span> <span class="n">protected</span><span class="p">,</span>
                <span class="s2">&quot;control&quot;</span><span class="p">:</span> <span class="n">control</span><span class="p">,</span>
                <span class="s2">&quot;sample_weight&quot;</span><span class="p">:</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sample_weight</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y_pred&quot;</span><span class="p">,</span> <span class="s2">&quot;protected&quot;</span><span class="p">,</span> <span class="s2">&quot;control&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">))</span>
        <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y_pred&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">))</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.adverse_impact_ratio_at_thresholds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">adverse_impact_ratio_at_thresholds</span><span class="p">(</span><span class="n">y_score</span><span class="p">,</span> <span class="n">protected</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the Adverse Impact Ratio (AIR) at each threshold of <code>y_score</code>. See
<a class="autorefs autorefs-internal" title="adverse_impact_ratio(y_pred, protected, control, sample_weight=None)" href="#rapidstats.metrics.adverse_impact_ratio">rapidstats.metrics.adverse_impact_ratio</a> for more details. When the <code>strategy</code> is
<code>cum_sum</code>, computes</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">y_score</span><span class="p">:</span>
    <span class="n">is_predicted_negative</span> <span class="o">=</span> <span class="n">y_score</span> <span class="o">&lt;</span> <span class="n">t</span>
    <span class="n">adverse_impact_ratio</span><span class="p">(</span><span class="n">is_predicted_negative</span><span class="p">,</span> <span class="n">protected</span><span class="p">,</span> <span class="n">control</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>protected</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array of booleans identifying the protected class</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array of booleans identifying the control class</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_weight</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="polars.series.series.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample weights, set to 1 if None</p>
<div class="admonition version">
<p class="admonition-title">Version</p>
<p>Added 0.2.0</p>
</div>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>thresholds</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The thresholds to compute <code>is_predicted_negative</code> at, i.e. y_score &lt; t. If None,
uses every score present in <code>y_score</code>, by default None</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy</code>
            </td>
            <td>
                  <code><span title="rapidstats.metrics.LoopStrategy">LoopStrategy</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Computation method, by default "auto"</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="polars.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataFrame of <code>threshold</code> and <code>air</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">adverse_impact_ratio_at_thresholds</span><span class="p">(</span>
    <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">protected</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">control</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thresholds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n">LoopStrategy</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the Adverse Impact Ratio (AIR) at each threshold of `y_score`. See</span>
<span class="sd">    [rapidstats.metrics.adverse_impact_ratio][] for more details. When the `strategy` is</span>
<span class="sd">    `cum_sum`, computes</span>


<span class="sd">    ``` py</span>
<span class="sd">    for t in y_score:</span>
<span class="sd">        is_predicted_negative = y_score &lt; t</span>
<span class="sd">        adverse_impact_ratio(is_predicted_negative, protected, control)</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>
<span class="sd">    protected : ArrayLike</span>
<span class="sd">        An array of booleans identifying the protected class</span>
<span class="sd">    control : ArrayLike</span>
<span class="sd">        An array of booleans identifying the control class</span>
<span class="sd">    sample_weight: Optional[ArrayLike], optional</span>
<span class="sd">        Sample weights, set to 1 if None</span>

<span class="sd">        !!! Version</span>
<span class="sd">            Added 0.2.0</span>
<span class="sd">    thresholds : Optional[list[float]], optional</span>
<span class="sd">        The thresholds to compute `is_predicted_negative` at, i.e. y_score &lt; t. If None,</span>
<span class="sd">        uses every score present in `y_score`, by default None</span>
<span class="sd">    strategy : LoopStrategy, optional</span>
<span class="sd">        Computation method, by default &quot;auto&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pl.DataFrame</span>
<span class="sd">        A DataFrame of `threshold` and `air`</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">has_sample_weight</span> <span class="o">=</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;y_score&quot;</span><span class="p">:</span> <span class="n">y_score</span><span class="p">,</span>
            <span class="s2">&quot;protected&quot;</span><span class="p">:</span> <span class="n">protected</span><span class="p">,</span>
            <span class="s2">&quot;control&quot;</span><span class="p">:</span> <span class="n">control</span><span class="p">,</span>
            <span class="s2">&quot;sample_weight&quot;</span><span class="p">:</span> <span class="n">sample_weight</span> <span class="k">if</span> <span class="n">has_sample_weight</span> <span class="k">else</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;protected&quot;</span><span class="p">,</span> <span class="s2">&quot;control&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">),</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y_score&quot;</span><span class="p">,</span> <span class="s2">&quot;sample_weight&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">strategy</span> <span class="o">=</span> <span class="n">_set_loop_strategy</span><span class="p">(</span><span class="n">thresholds</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_air</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
                <span class="s2">&quot;air&quot;</span><span class="p">:</span> <span class="n">_adverse_impact_ratio</span><span class="p">(</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y_score&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;y_pred&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;protected&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;control&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;sample_weight&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">),</span>
            <span class="p">}</span>

        <span class="n">airs</span> <span class="o">=</span> <span class="n">_run_concurrent</span><span class="p">(</span><span class="n">_air</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">thresholds</span> <span class="ow">or</span> <span class="n">y_score</span><span class="p">))</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">(</span><span class="n">airs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;cum_sum&quot;</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">_air_at_thresholds_core</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">,</span> <span class="n">has_sample_weight</span><span class="o">=</span><span class="n">has_sample_weight</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_fill_infinite</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fill_nan</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.average_precision" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">average_precision</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes Average Precision.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_weight</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="polars.series.series.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample weights, set to 1 if None</p>
<div class="admonition version">
<p class="admonition-title">Version</p>
<p>Added 0.2.0</p>
</div>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Average Precision (AP)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">average_precision</span><span class="p">(</span>
    <span class="n">y_true</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes Average Precision.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : ArrayLike</span>
<span class="sd">        Ground truth target</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>
<span class="sd">    sample_weight: Optional[ArrayLike], optional</span>
<span class="sd">        Sample weights, set to 1 if None</span>

<span class="sd">        !!! Version</span>
<span class="sd">            Added 0.2.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Average Precision (AP)</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">_y_true_y_score_to_df</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
        <span class="o">.</span><span class="n">lazy</span><span class="p">()</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;y_score&quot;</span><span class="p">:</span> <span class="s2">&quot;threshold&quot;</span><span class="p">})</span>
        <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_base_confusion_matrix_at_thresholds</span><span class="p">)</span>
        <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_full_confusion_matrix_from_base</span><span class="p">)</span>
        <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">,</span> <span class="s2">&quot;tpr&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">drop_nulls</span><span class="p">()</span>
        <span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">_ap_from_pr_curve</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;precision&quot;</span><span class="p">),</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;tpr&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ap&quot;</span><span class="p">))</span>
        <span class="o">.</span><span class="n">collect</span><span class="p">()[</span><span class="s2">&quot;ap&quot;</span><span class="p">]</span>
        <span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.brier_loss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">brier_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the Brier loss (smaller is better). The Brier loss measures the mean
squared difference between the predicted scores and the ground truth target.
Calculated as:</p>
<div class="arithmatex">\[ \frac{1}{N} \sum_{i=1}^N (yt_i - ys_i)^2 \]</div>
<p>where <span class="arithmatex">\( yt \)</span> is <code>y_true</code> and <span class="arithmatex">\( ys \)</span> is <code>y_score</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Brier loss</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">brier_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Computes the Brier loss (smaller is better). The Brier loss measures the mean</span>
<span class="sd">    squared difference between the predicted scores and the ground truth target.</span>
<span class="sd">    Calculated as:</span>

<span class="sd">    \[ \frac{1}{N} \sum_{i=1}^N (yt_i - ys_i)^2 \]</span>

<span class="sd">    where \( yt \) is `y_true` and \( ys \) is `y_score`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : ArrayLike</span>
<span class="sd">        Ground truth target</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Brier loss</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_y_true_y_score_to_df</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_brier_loss</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.confusion_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes confusion matrix metrics (TP, FP, TN, FN, TPR, Fbeta, etc.).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_pred</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beta</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\( \beta \)</span> to use in <span class="arithmatex">\( F_\beta \)</span>, by default 1</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_weight</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="polars.series.series.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample weights, set to 1 if None</p>
<div class="admonition version">
<p class="admonition-title">Version</p>
<p>Added 0.2.0</p>
</div>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfusionMatrix


  
      dataclass
   (rapidstats.metrics.ConfusionMatrix)" href="#rapidstats.metrics.ConfusionMatrix">ConfusionMatrix</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataclass of confusion matrix metrics</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confusion_matrix</span><span class="p">(</span>
    <span class="n">y_true</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">y_pred</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConfusionMatrix</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Computes confusion matrix metrics (TP, FP, TN, FN, TPR, Fbeta, etc.).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : ArrayLike</span>
<span class="sd">        Ground truth target</span>
<span class="sd">    y_pred : ArrayLike</span>
<span class="sd">        Predicted target</span>
<span class="sd">    beta : float, optional</span>
<span class="sd">        \( \beta \) to use in \( F_\beta \), by default 1</span>
<span class="sd">    sample_weight: Optional[ArrayLike], optional</span>
<span class="sd">        Sample weights, set to 1 if None</span>

<span class="sd">        !!! Version</span>
<span class="sd">            Added 0.2.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ConfusionMatrix</span>
<span class="sd">        Dataclass of confusion matrix metrics</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_y_true_y_pred_to_df</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y_true&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt8</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">ConfusionMatrix</span><span class="p">(</span><span class="o">*</span><span class="n">_confusion_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.confusion_matrix_at_thresholds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confusion_matrix_at_thresholds</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">DefaultConfusionMatrixMetrics</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the confusion matrix at each threshold. When the <code>strategy</code> is
"cum_sum", computes</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">y_score</span><span class="p">:</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_score</span> <span class="o">&gt;=</span> <span class="n">t</span>
    <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</code></pre></div>
<p>using fast DataFrame operations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>thresholds</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The thresholds to compute <code>y_pred</code> at, i.e. y_score &gt;= t. If None,
uses every score present in <code>y_score</code>, by default None</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metrics</code>
            </td>
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="rapidstats.metrics.ConfusionMatrixMetric">ConfusionMatrixMetric</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The metrics to compute, by default DefaultConfusionMatrixMetrics</p>
              </div>
            </td>
            <td>
                  <code><span title="rapidstats.metrics.DefaultConfusionMatrixMetrics">DefaultConfusionMatrixMetrics</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy</code>
            </td>
            <td>
                  <code><span title="rapidstats.metrics.LoopStrategy">LoopStrategy</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Computation method, by default "auto"</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beta</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\( \beta \)</span> to use in <span class="arithmatex">\( F_\beta \)</span>, by default 1</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_weight</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="polars.series.series.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample weights, set to 1 if None</p>
<div class="admonition version">
<p class="admonition-title">Version</p>
<p>Added 0.2.0</p>
</div>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="polars.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Polars DataFrame of <code>threshold</code>, <code>metric</code>, and <code>value</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confusion_matrix_at_thresholds</span><span class="p">(</span>
    <span class="n">y_true</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">thresholds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ConfusionMatrixMetric</span><span class="p">]</span> <span class="o">=</span> <span class="n">DefaultConfusionMatrixMetrics</span><span class="p">,</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n">LoopStrategy</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Computes the confusion matrix at each threshold. When the `strategy` is</span>
<span class="sd">    &quot;cum_sum&quot;, computes</span>

<span class="sd">    ``` py</span>
<span class="sd">    for t in y_score:</span>
<span class="sd">        y_pred = y_score &gt;= t</span>
<span class="sd">        confusion_matrix(y_true, y_pred)</span>
<span class="sd">    ```</span>

<span class="sd">    using fast DataFrame operations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : ArrayLike</span>
<span class="sd">        Ground truth target</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>
<span class="sd">    thresholds : Optional[list[float]], optional</span>
<span class="sd">        The thresholds to compute `y_pred` at, i.e. y_score &gt;= t. If None,</span>
<span class="sd">        uses every score present in `y_score`, by default None</span>
<span class="sd">    metrics : Iterable[ConfusionMatrixMetric], optional</span>
<span class="sd">        The metrics to compute, by default DefaultConfusionMatrixMetrics</span>
<span class="sd">    strategy : LoopStrategy, optional</span>
<span class="sd">        Computation method, by default &quot;auto&quot;</span>
<span class="sd">    beta : float, optional</span>
<span class="sd">        \( \beta \) to use in \( F_\beta \), by default 1</span>
<span class="sd">    sample_weight: Optional[ArrayLike], optional</span>
<span class="sd">        Sample weights, set to 1 if None</span>

<span class="sd">        !!! Version</span>
<span class="sd">            Added 0.2.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pl.DataFrame</span>
<span class="sd">        A Polars DataFrame of `threshold`, `metric`, and `value`</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">strategy</span> <span class="o">=</span> <span class="n">_set_loop_strategy</span><span class="p">(</span><span class="n">thresholds</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">_y_true_y_score_to_df</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_cm</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">confusion_matrix</span><span class="p">(</span>
                    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_true&quot;</span><span class="p">],</span>
                    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
                    <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span>
                    <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">to_polars</span><span class="p">()</span>
                <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="n">cms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="n">_run_concurrent</span><span class="p">(</span><span class="n">_cm</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">thresholds</span> <span class="ow">or</span> <span class="n">y_score</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">cms</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_nan</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;cum_sum&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;y_true&quot;</span><span class="p">:</span> <span class="n">y_true</span><span class="p">,</span>
                    <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="n">y_score</span><span class="p">,</span>
                    <span class="s2">&quot;sample_weight&quot;</span><span class="p">:</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sample_weight</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y_true&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">))</span>
            <span class="o">.</span><span class="n">drop_nulls</span><span class="p">()</span>
            <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_base_confusion_matrix_at_thresholds</span><span class="p">)</span>
            <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_full_confusion_matrix_from_base</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
            <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">metrics</span><span class="p">)</span>
            <span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_map_to_thresholds</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">)</span>
            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_threshold_actual&quot;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="o">.</span><span class="n">unpivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;threshold&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;metric&quot;</span><span class="p">})</span>
            <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.max_ks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_ks</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Performs the two-sample Kolmogorov-Smirnov test on the predicted scores of the
ground truth positive and ground truth negative classes. The KS test measures the
highest distance between two CDFs, so the Max-KS metric measures how well the model
separates two classes. In pseucode:</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span>
<span class="n">class0</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">~</span><span class="n">y_true</span><span class="p">)[</span><span class="s2">&quot;y_score&quot;</span><span class="p">]</span>
<span class="n">class1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">y_true</span><span class="p">)[</span><span class="s2">&quot;y_score&quot;</span><span class="p">]</span>

<span class="n">ks</span><span class="p">(</span><span class="n">class0</span><span class="p">,</span> <span class="n">class1</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Max-KS</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">max_ks</span><span class="p">(</span><span class="n">y_true</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs the two-sample Kolmogorov-Smirnov test on the predicted scores of the</span>
<span class="sd">    ground truth positive and ground truth negative classes. The KS test measures the</span>
<span class="sd">    highest distance between two CDFs, so the Max-KS metric measures how well the model</span>
<span class="sd">    separates two classes. In pseucode:</span>

<span class="sd">    ``` py</span>
<span class="sd">    df = Frame(y_true, y_score)</span>
<span class="sd">    class0 = df.filter(~y_true)[&quot;y_score&quot;]</span>
<span class="sd">    class1 = df.filter(y_true)[&quot;y_score&quot;]</span>

<span class="sd">    ks(class0, class1)</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : ArrayLike</span>
<span class="sd">        Ground truth target</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Max-KS</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_y_true_y_score_to_df</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_max_ks</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.mean" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the mean of the input array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D-array of numbers</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mean</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the mean of the input array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : ArrayLike</span>
<span class="sd">        A 1D-array of numbers</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Mean</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_mean</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">}))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.mean_squared_error" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes Mean Squared Error (MSE) as</p>
<div class="arithmatex">\[ \frac{1}{N} \sum_{i=1}^{N} (yt_i - ys_i)^2 \]</div>
<p>where <span class="arithmatex">\( yt \)</span> is <code>y_true</code> and <span class="arithmatex">\( ys \)</span> is <code>y_score</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mean Squared Error (MSE)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Computes Mean Squared Error (MSE) as</span>

<span class="sd">    \[ \frac{1}{N} \sum_{i=1}^{N} (yt_i - ys_i)^2 \]</span>

<span class="sd">    where \( yt \) is `y_true` and \( ys \) is `y_score`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : ArrayLike</span>
<span class="sd">        Ground truth target</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Mean Squared Error (MSE)</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_mean_squared_error</span><span class="p">(</span><span class="n">_regression_to_df</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.predicted_positive_ratio_at_thresholds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predicted_positive_ratio_at_thresholds</span><span class="p">(</span><span class="n">y_score</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the Predicted Positive Ratio (PPR) at each threshold, where the PPR is
the ratio of predicted positive to the total, and a positive is defined as
<code>y_score</code> &gt;= threshold.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_weight</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="polars.series.series.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample weights, set to 1 if None</p>
<div class="admonition version">
<p class="admonition-title">Version</p>
<p>Added 0.2.0</p>
</div>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>thresholds</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The thresholds to compute <code>y_pred</code> at, i.e. y_score &gt;= t. If None,
uses every score present in <code>y_score</code>, by default None</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy</code>
            </td>
            <td>
                  <code><span title="rapidstats.metrics.LoopStrategy">LoopStrategy</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Computation method, by default "auto"</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="polars.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataFrame of <code>threshold</code> and <code>ppr</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">predicted_positive_ratio_at_thresholds</span><span class="p">(</span>
    <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thresholds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n">LoopStrategy</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the Predicted Positive Ratio (PPR) at each threshold, where the PPR is</span>
<span class="sd">    the ratio of predicted positive to the total, and a positive is defined as</span>
<span class="sd">    `y_score` &gt;= threshold.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>
<span class="sd">    sample_weight: Optional[ArrayLike], optional</span>
<span class="sd">        Sample weights, set to 1 if None</span>

<span class="sd">        !!! Version</span>
<span class="sd">            Added 0.2.0</span>
<span class="sd">    thresholds : Optional[list[float]], optional</span>
<span class="sd">        The thresholds to compute `y_pred` at, i.e. y_score &gt;= t. If None,</span>
<span class="sd">        uses every score present in `y_score`, by default None</span>
<span class="sd">    strategy : LoopStrategy, optional</span>
<span class="sd">        Computation method, by default &quot;auto&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pl.DataFrame</span>
<span class="sd">        A DataFrame of `threshold` and `ppr`</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lf</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;y_score&quot;</span><span class="p">:</span> <span class="n">y_score</span><span class="p">,</span>
            <span class="s2">&quot;sample_weight&quot;</span><span class="p">:</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sample_weight</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">drop_nulls</span><span class="p">()</span>

    <span class="n">strategy</span> <span class="o">=</span> <span class="n">_set_loop_strategy</span><span class="p">(</span><span class="n">y_score</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_ppr</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
                <span class="s2">&quot;ppr&quot;</span><span class="p">:</span> <span class="n">_weighted_mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sample_weight&quot;</span><span class="p">]),</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">_run_concurrent</span><span class="p">(</span><span class="n">_ppr</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">thresholds</span> <span class="ow">or</span> <span class="n">y_score</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;cum_sum&quot;</span><span class="p">:</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_cumulative_ppr</span><span class="p">(</span><span class="n">lf</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span> <span class="n">has_sample_weight</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">has_sample_weight</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">lf</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">(</span>
                    <span class="s2">&quot;cumulative_predicted_positive&quot;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">1</span>
                <span class="p">)</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
                    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;cumulative_predicted_positive&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">truediv</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">len</span><span class="p">())</span>
                    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ppr&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">lf</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
                    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sample_weight&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">cum_sum</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cumulative_predicted_positive&quot;</span><span class="p">)</span>
                <span class="p">)</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
                    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;cumulative_predicted_positive&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">truediv</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sample_weight&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
                    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ppr&quot;</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">lf</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;y_score&quot;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_cumulative_ppr</span><span class="p">,</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
            <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;y_score&quot;</span><span class="p">:</span> <span class="s2">&quot;threshold&quot;</span><span class="p">})</span>
            <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="s2">&quot;ppr&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_map_to_thresholds</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">)</span>
            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_threshold_actual&quot;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.r2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">r2</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes R2 as</p>
<div class="arithmatex">\[
    1 - \frac{\sum{(y_i - \hat{y_i})^2}{}}{\sum{(y_{i} - \bar{y})^2}}
\]</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>R2</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">r2</span><span class="p">(</span><span class="n">y_true</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Computes R2 as</span>

<span class="sd">    \[</span>
<span class="sd">        1 - \frac{\sum{(y_i - \hat{y_i})^2}{}}{\sum{(y_{i} - \bar{y})^2}}</span>
<span class="sd">    \]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : ArrayLike</span>
<span class="sd">        Ground truth target</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        R2</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_r2</span><span class="p">(</span><span class="n">_regression_to_df</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.roc_auc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">roc_auc</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes Area Under the Receiver Operating Characteristic Curve.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_weight</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="polars.series.series.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample weights, set to 1 if None</p>
<div class="admonition version">
<p class="admonition-title">Version</p>
<p>Added 0.2.0</p>
</div>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ROC-AUC</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">roc_auc</span><span class="p">(</span>
    <span class="n">y_true</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes Area Under the Receiver Operating Characteristic Curve.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : ArrayLike</span>
<span class="sd">        Ground truth target</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>
<span class="sd">    sample_weight: Optional[ArrayLike], optional</span>
<span class="sd">        Sample weights, set to 1 if None</span>

<span class="sd">        !!! Version</span>
<span class="sd">            Added 0.2.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        ROC-AUC</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_y_true_y_score_to_df</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y_true&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">_roc_auc</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rapidstats.metrics.root_mean_squared_error" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes Root Mean Squared Error (RMSE) as</p>
<div class="arithmatex">\[ \sqrt{\frac{1}{N} \sum_{i=1}^{N} (yt_i - ys_i)^2} \]</div>
<p>where <span class="arithmatex">\( yt \)</span> is <code>y_true</code> and <span class="arithmatex">\( ys \)</span> is <code>y_score</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth target</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_score</code>
            </td>
            <td>
                  <code><span title="polars.series.series.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted scores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Root Mean Squared Error (RMSE)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="added-in-version-0.1.0" open>
  <summary>Added in version 0.1.0</summary>
  
</details>

            <details class="quote">
              <summary>Source code in <code>python/rapidstats/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">root_mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">y_score</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Computes Root Mean Squared Error (RMSE) as</span>

<span class="sd">    \[ \sqrt{\frac{1}{N} \sum_{i=1}^{N} (yt_i - ys_i)^2} \]</span>

<span class="sd">    where \( yt \) is `y_true` and \( ys \) is `y_score`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : ArrayLike</span>
<span class="sd">        Ground truth target</span>
<span class="sd">    y_score : ArrayLike</span>
<span class="sd">        Predicted scores</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Root Mean Squared Error (RMSE)</span>

<span class="sd">    Added in version 0.1.0</span>
<span class="sd">    ----------------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_root_mean_squared_error</span><span class="p">(</span><span class="n">_regression_to_df</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_score</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["content.code.copy"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>